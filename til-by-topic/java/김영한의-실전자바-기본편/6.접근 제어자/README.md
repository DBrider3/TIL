# 6. 접근 제어자

## 접근 제어자 이해 1
자바는 `public, private`같은 접근 제어자(access modifier)를 제공한다. 접근 제어자를 사용하면 해당 클래스 외부에서 특정 필드나 메서드에 접근하는 것을 허용하거나 제한할 수 있다.

왜 필요할까? 다음과 같은 예시가 있다.
- 스피커에 들어가는 SW 개발자이다.
- 스피커 음량은 100을 절대 넘으면 안된다는 요구사항이 있다. (**100을 넘어가면 스피커의 부품이 고장난다.**)
- 오랜 시간이 흘러 업그레이된 다음 버전을 출시하려고 한다. 새로운 개발자가 급하게 기존 코드를 맡아서 개발을 하게 되었다.
- 기존 요구사항을 잘 몰랐고, 100을 넘지 않는게 이상하다고 느껴서 `Speaker`클래스를 보고 `volume`필드를 직접 사용할 수 있어서 필드의 값을 200으로 설정했다.
- 이 코드를 실행하는 순간 스피커의 부품들에 과부화가 걸리면서 폭발했다.
- 그렇게 뉴스에 방화범이 되어버렸다.

큰 사건이 일어나기에 앞서 `volumUp`이라는 메서드는 음량이 100을 넘지 못하도록 막았지만 필드에 직접 접근이 가능하기에 일어나는 문제였다.
이런 문제를 근본적으로 해결하기 위해서는 `volume`필드의 외부 접근을 막을 수 있는 방법이 필요하다.


## 접근 제어자 이해 2
`private`라는 접근제어자를 통해 `volme` 필드를 `Speaker`내부에서만 접근 할 수 있게 만들자.
이제 외부에서 해당 필드의 접근을 막아두었다. 
결과적으로 처음부터 접근제어자를 통해 막아놓았다면 폭발하지 않았을것이다.
> **참고:** 좋은 프로그램은 무한한 자유도가 주어지는 프로그램이 아니라 적절한 제약을 제공하는 프로그램이다.

## 접근 제어자 종류
**종류**
- `private`: 모든 외부 호출을 막는다.
- `default`(package-private): 같은 패키지안에서 호출은 허용한다.
- `protected`: 같은 패키지안에서 호출은 허용한다. 패키지가 달라도 상속 관계의 호출은 허용한다. 
- `public`: 모든 외부 호출을 허용한다.

순서대로 `private`이 가장 많이 차단하고, `public`이 가장 많이 허용한다.
`private -> default -> protected -> public`

**package-private**
접근 제어자를 명시하지 않으면 같은 패키지 안에서 호출을 허용하는 `default` 접근 제어자가 적용된다.
`default`라는 용어는 해당 접근 제어자가 기본값으로 사용되기 때문에 붙여진 이름이지만, 실제로는 `package-private`이 더 정확한 표현이다. 
왜냐하면 해당 접근 제어자를 사용하는 멤버는 동일한 패키지 내의 다른 클래스에서만 접근이 가능하기 때문이다. 참고로 두 용어를 함께 사용한다.

**접근 제어자 사용 위치**
접근 제어자는 필드와 메서드, 생성자에 사용된다.
추가로 클래스 레벨에도 일부 접근 제어자를 사용할 수 있다. 

**접근 제어자의 핵심은 속성과 기능을 외부로부터 숨기는 것이다.**
- `private` 은 나의 클래스 안으로 속성과 기능을 숨길 때 사용, 외부 클래스에서 해당 기능을 호출할 수 없다.
- `default`는 나의 패키지 안으로 속성과 기능을 숨길 때 사용, 외부 패키지에서 해당 기능을 호출할 수 없다.
- `protected`는 상속 관계로 속성과 기능을 숨길 때 사용, 상속 관계가 아닌 곳에서 해당 기능을 호출할 수 없다.
- `public`은 기능을 숨기지 않고 어디서든 호출할 수 있게 공개한다.

## 접근 제어자 사용 - 클래스 레벨
**클래스 레벨의 접근 제어자 규칙**
- 클래스 레벨의 접근 제어자는 `public`, `default`만 사용할 수 있다.
	- `private`, `protected`는 사용할 수 없다.
- `public`클래스는 반드시 파일명과 이름이 같아야 한다.
	- 하나의 자바 파일에 `public`클래스는 하나만 등장할 수 있다.
	- 하나의 자바 파일에 `default`접근 제어자를 사용하는 클래스는 무한정 만들 수 있다.

**`PublicClass.java`파일**
```java
package access.a;  
  
public class PublicClass {  
    public static void main(String[] args) {  
        PublicClass publicClass = new PublicClass();  
        DefaultClass1 class1 = new DefaultClass1();  
        DefaultClass2 class2 = new DefaultClass2();  
  
    }  
}  
  
class DefaultClass1 {  
  
}  
  
class DefaultClass2 {  
      
}
```
- 패키지 위치는 `package.access.a`이다. 패키지 위치를 꼭 맞춰야 한다. 주의~
- `DefaultClass1`, `DefaultClass2`는 `default`접근 제어자다. 이 클래스는 `default`이기 때문에 같은 패키지 내부에서만 접근할 수 있다.

## 캡슐화
캡슐화(Encapsulation)는 객체 지향 프로그래밍의 중요한 개념 중 하나다. 캡슐화는 데이터와 해당 데이터를 처리하는 메서드를 하나로 묶어서 외부에서의 접근을 제한하는 것을 말한다. 캡슐화를 통해 데이터의 직접적인 변경을 방지하거나 제한할 수 있다.
캡슐화는 쉽게 이야기해서 속성과 기능을 하나로 묶고, 외부에 꼭 필요한 기능만 노출하고 나머지는 모두 내부로 숨기는 것이다.

이전에 객체 지향 프로그래밍을 설명하면서 캡슐화에 대해 알아보았다. 이때는 데이터와 데이터를 처리하는 메서드를 하나로 모으는 것에 초점을 맞추었다. 여기서 한발짝 더 나아가 캡슐화를 안전하게 완성할 수 있게 해주는 장치가 바로 접근 제어자다.

**1.데이터를 숨겨라**
객체에는 속성(데이터), 기능(메서드)이 있다. 캡슐화에서 가장 필수로 숨겨야 하는 것은 속성(데이터)이다.
`Speaker`의 `volume`을 떠올려보자. 객체 내부의 데이터를 외부에서 함부로 접근하게 두면, 클래스 안에서 데이터를 다루는 모든 로직을 무시하고 데이터를 변경할 수 있다. 결국 모든 안전망을 다 빠져나가게 된다. 따라서 캡슐화가 깨진다. 

우리는 자동차를 운전할 때 자동차 부품을 다 열어서 그 안에 있는 속도계를 직접 조절하지 않는다. 단지 자동차가 제공하는 엑셀 기능을 사용해서 엑셀을 밟으면 자동차가 나머지는 다 알아서 하는 것이다.

우리가 일상에서 생각할 수 있는 음악 플레이어를 떠올려보자. 음악 플레이어를 사용할 때 그 내부에 들어있는 전원부나, 볼륨 상태의 데이터를 직접 수정할 일이 있을까? 없다. 그냥 음악 플에이어의 켜고, 끄고, 볼륨 조절이 다이다. 
내부에 있는 전원부나, 볼륨의 상태 데이터를 직접 수정하지 않는다. 전원 버튼을 눌렀을 때 실제 전원을 받아서 전원을 켜는 것은 음악 플레이어의 일이다. 볼륨을 높였을 때 내부에 있는 볼륨 장치들을 움직이고 볼륨 수치를 조절하는 것도 음악 플레이어가 스스로 해야하는 일이다. 쉽게 이야기해서 우리는 음악 플레이어가 제공하는 기능을 통해서 음악 플레이어를 사용하는 것이다. 복잡하게 음악 플레이어의 내부를 까서 그 내부 데이터까지 우리가 직접 사용하는 것은 아니다.

**객체의 데이터는 객체가 제공하는 기능인 메서드를 통해서 접근해야 한다.**

**2.기능을 숨겨라**
객체의 기능 중에서 외부에서 사용하지 않고 내부에서만 사용하는 기능들이 있다. 이런 기능도 모두 감추는 것이 좋다. 우리가 자동차를 운전하기 위해 자동차가 제공하는 복잡한 엔진 조절 기능, 배기 기능 까지 우리가 알 필요는 없다. 우리는 단지 엑셀과 핸들 정도의 기능만 알면 된다.
만약 사용자에게 이런 기능까지 모두 알려준다면, 사용자가 자동차에 대해 너무 많은 것을 알아야 한다.
사용자의 입장에서 꼭 필요한 기능만 외부에 노출하자. 나머지 기능은 모두 내부로 숨기자.

**정리하면 데이터는 모두 숨기고, 기능은 꼭 필요한 기능만 노출하는 것이 좋은 캡슐화이다.**

**예시를 보며 느낀점**
- 클래스 내부에서만 쓰는 메서드(검증 메서드 등등)은 `private`로 작성하는것이 좋다.
	- 예시로 `public`으로 공개로 한다면 이미 다른 메서드에 검증 메서드를 쓰고 있는데 다른 개발자가 사용할때 접근이 가능하니 `내가 검증을 하라고 public으로 냅둔거 아냐?`라고 생각할 수 있는 혼돈을 준다. ``
- 데이터 필드는 외부에 직접 노출 금지. 메서드를 통해서 접근할 수 있게 한다.
- 접근 제어자와 캡슐화를 통해 데이터를 안전하게 보호하는 것은 물론, 해당 클래스를 사용하는 개발자 입장에서 해당 기능을 사용하는 복잡도를 낮출 수 있다.

## 문제
**배운점**
- `Item`클래스의 `price`, `quantity`가 있는데 상품별 합계를 구해야 한다면 데이터 필드를 외부로 반환한 다음에 외부에서 곱하는것보단 `getTotalPrice()`라는 메서드를 `public` 접근제어자로 구현해 놓는게 더 효과적이다.
  이 메서드의 핵심은 자신이 가진 데이터를 사용한다는 점이다.
- 로직은 최대한 분리를 하고 내부에서만 쓰는 기능은 `private`접근 제어자로 하는것이 좋다.
- 기능 구현할때 `검증` -> `실행` 로직 순으로 작성하는것이 좋다. 검증할 것이 많아질수도 있고 가독성도 좋다.
